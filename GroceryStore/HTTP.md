# HTTP的认识入门

HTTP设计之初只是早期用来传输/交换文件，使用非常局限，由于后来的网络的发展，浏览器和服务器迅速的扩展其内容，使HTTP协议应用更加的广泛。例如图片的传输、视频等。

早期的HTTP协议后来被称为HTTP/0.9,在HTTP/1.x中增加了请求头，响应体等扩展，也加入了`POST`、`HEAD`等请求方法。是基于TCP/IP协议栈上发送信息。后续在此基础上也加入了加密传输层SSL。

## URI

基于TCP/IP协议，当然这个URI的设计也就是这样的。URI文法一般由：协议、主机名、端口、路径、参数构成。其中也可能包含协议权限信息，比如用户名和密码。

一个URI就指向一个万维网中的一个资源。URI术语也称“统一资源标识符”。

## MIME

HTTP被扩展之后，可以支持多种媒体协议。例如声音、图像、PDF文档、视频等等。该参数就可以设置使浏览器自动指定应用程序打开。就像我们常做的文件下载功能。

常见的MIME类型有：`text/html`、`text/xml`、`text/plain`、`image/png`、`application/pdf`、`application/json`等

## HTTP协议的特点

HTTP协议使基于请求与响应：

- 简单快速：只需要填写请求路径、请求方法

- 灵活：允许客户端和服务端传输任意类型格式的数据

- 无连接：限制每次连接只处理一个请求。服务器处理完客户端的请求，并收到客户端的应答之后，即断开连接。

早期设计的时候，考虑到每次请求之间并无多大关联，为了释放资源，就设计时规定一次连接处理完请求之后就关闭连接。但是在互联网兴起之后，一个网页可能都包含多个图片，而每个图片就是个单独的资源，需要单独的建立连接获取。这样就很影响性能。所以后面设计加入了`keep-alive`状态，当连接保持的时候就可以连续使用一个连接处理多个请求。

- 无状态：指对于事物处理没有记忆能力，服务器不知道客户端是什么状态

上面这几点特点也会使HTTP协议随之产生新的问题。比如：

（1）无连接特点，随之而来的是`websocket`协议  
（2）无状态特点，随之产生的新事物`cookie`、`session`

## 请求报文和响应报文

请求报文由：请求头、请求行、空行、请求体组成。

响应报文由：状态行、响应头、空行、响应体组成。

# GET请求和POST请求的区别

有时会觉得`GET`也可以做`POST`的事情，为什么在后续的设计中加入了`POST`方法。在实际中的使用中，这些是和浏览器息息相关的。比如浏览器对url长度的显示，GET请求地址的可见性。

（1） `GET`是被强制服务器支持，`POST`是服务器可选支持。这是HTTP协议中的规定，但是一般来说服务器都是支持的

（2）HTTP协议虽然没有规定URL的长度。但是浏览器一般在实现时都做了限制。所以`GET`是不能发送大量数据的，而`POST`则可以在这点上代替`GET`的功能

（3）`GET`请求是安全的：协议中规定`GET`请求是不会修改服务器数据的。

（4）`GET`、`PUT`、`DELETE`都是幂等的

（5）`POST`请求针对`GET`来说是安全的：针对抓包来说，这两者并没有区别，都是裸露的。只是从便面上看，GET请求是直接反映在浏览器的地址栏的，而POST却不是。

# 浏览器的`cookie`功能

## `cookie`来源和简介

由于HTTP的无连接、无状态特性，使得在实际工作中很不方便，后来浏览器引入了`cookie`功能，用来做用户认证、服务器校验等，还可以处理一些文本信息。

实际上我们从浏览器中可以看见，`cookie`就是存在浏览器中的纯文本，在浏览器的安装目录下会有一个专门的目录用来存放各个域的`cookie`。当发送http请求时，浏览器会检查相应的`cookie`，有则自动添加在`request header`中的`cookie`字段中。

- 存储在`cookie`中的数据，会自动放在http请求中，无论是否需要，着增加了网络的开销。 

- 用来处理携带认证信息，则可以免去重复操作

- `cookie`可以用来存放少量数据（4k），每个域名下的`cookie`数量最多20个

## `cookie`格式

`cookie`本身就是字符串，由键值对组成`key=value`,键值对之间由分号`;`和空格` `隔开。

```
key=name; expires=Thu, 25 Feb 2016 04:18:00 GMT; domain=ppsc.sankuai.com; path=/; secure; HttpOnly
```

`cookie`属性选项包括：`expires`、`domain`、`path`、`secure`、`HttpOnly`


客户端和服务端都可以设置`cookie`。一般`HttpOnly`属性是由服务端设置的，设置该属性之后，则该`cookie`不同通过js脚本来进行修改。在修改或者删除`cookie`时，不仅需要`key=value`保持一致，还需要保持选项值`domain`和`path`一致，否则会视为增加`cookie`。


# 浏览器中输入url到底都发生了些什么

- DNS域名服务器解析域名： 解析域名，找到对应的服务器地址。

- 客户端与服务器建立TCP连接： 3次握手，建立连接，建立连接成功之后才能收发数据

- 客户端发送HTTP请求

- 服务器处理数据：HTTP服务器处理请求（Apache、Nginx等）

- 返回响应结果

1xx(请求成功，服务器正在处理数据)  
2xx(处理成功)  
3xx(重定向)  
4xx(客户端出现错误，服务端无法处理客户端发出的请求)  
5xx(服务端处理出现错误)

- 关闭TCP连接： 4次握手

- 浏览器解析HTML

- 浏览器布局渲染





