<!-- TOC -->

- [ping和telnet的区别（平时经常用来监测网络连通情况）](#ping和telnet的区别平时经常用来监测网络连通情况)
- [跨域](#跨域)
  - [同源策略](#同源策略)
  - [是否允许跨域的判定](#是否允许跨域的判定)
    - [浏览器判定流程](#浏览器判定流程)
    - [配置服务器实现跨域传输](#配置服务器实现跨域传输)
- [Redis的Pub/Sub](#redis的pubsub)

<!-- /TOC -->
# ping和telnet的区别（平时经常用来监测网络连通情况）
1. ping(用来检查网络是否通畅或者网络连接速度的命令)

（1）介绍：ping称为因特网包探索器，用于测试网络连接量的程序，通常是用来检查网络是否通畅或者网络连接速度的命令，Ping域名还可以得出解析IP。  
（2）原理：利用网络上机器IP地址的唯一性，给目标IP地址发送一个数据包，再要求对方返回一个同样大小的数据包来确定两台网络机器是否连接相通，时延是多少。  
（3）注意：ping指的是端对端连通，通常用来作为可用性的检查，但是某些病毒木马会强行大量远程执行ping命令抢占你的网络资源，导致系统变慢，网速变慢。严禁ping入侵作为大多数防火墙的一个基本功能提供给用户进行选择。通常的情况下你如果不用作服务器或者进行网络测试，ping是被防火墙禁用的（如果被禁用可以采取下面提到的telnet方式）  
（4）用法：ping ip地址（网址）即可  

2. telnet(用来探测指定ip是否开放指定端口)

（1）介绍：Telnet协议是TCP/IP协议族的其中之一，是Internet远端登录服务的标准协议和主要方式，常用于网页服务器的远端控制，可供使用者在本地主机执行远端主机上的工作。使用者首先在电脑执行Telnet程序，连线至目的地服务器，然后输入帐号和密码以验证身份。使用者可以在本地主机输入命令，然后让已连接的远端主机执行，就像直接在对方的控制台上输入一样。传统Telnet会话所传输的资料并未加密，帐号和密码等敏感资料容易会被窃听，因此很多服务器都会封锁Telnet服务，改用更安全的SSH。  
（2）用法
```
1.  telnet [-a][-e escape char][-f log file][-l user][-t term][host [port]] 
2.  -a      企图自动登录。除了用当前已登陆的用户名以外，与 -l 选项相同。 
3.  -e      跳过字符来进入 telnet 客户端提示。 
4.  -f      客户端登录的文件名 
5.  -l      指定远程系统上登录用的用户名称。 
6.  要求远程系统支持 TELNET ENVIRON 选项。 
7.   -t      指定终端类型。 
8.  支持的终端类型仅是: vt100, vt52, ansi 和 vtnt。 
9.   host    指定要连接的远程计算机的主机名或 IP 地址。 
10.  port    指定端口号或服务名。
```

ping与telnet的总结：Ping命令是用来检测网络是否畅通的，而Telnet命令则用来远程登陆。 但Ping不通并不一定代表网络不通。ping是基于ICMP协议的命令，就是你发出去一个数据包，对方收到后返给你一个！就好比声纳。这个协议是可以禁止的！禁止后，如果你ping对方，对方收到后就不回馈给你，这样你就显示无法ping通，但实际你们还是连着的！telnet是登陆服务器的！服务没禁止就能登陆。

实例解析：
> 希望对方提供一个内网服务器xxxx端口到域名对应的xxxx端口的外网访问入口。客户搞定之后，告诉我们弄好了。 telnet xxxxx..xxx xxxx 发现能够通。但是访问时发现得不到我们想到的结果。一直不知道什么原因。但是大概知道路由配置出错。一直以为telnet通了就好着，但是忽视了可能只是域名对应的端口开通了。内部服务器并没有对应上。结果让联通工程师调了之后成功。


# 跨域
前端经常遇到的问题`Access-Control-Allow-Origin`，俗称**跨域**。

由于安全问题考虑，浏览器有**同源策略**，对于不同源站点之间的相互请求会做限制，而对于不同源的站点之间相互请求就会出现上述所提的跨域问题。所以首先我们需要明确一点：**跨域问题实际上是由于浏览器的同源策略导致的**。

## 同源策略
> “同源策略”的图片搜索结果
同源策略（Same origin policy）是一种约定，它是浏览器最核心也最基本的安全功能，如果缺少了同源策略，则浏览器的正常功能可能都会受到影响。同源策略，它是由Netscape提出的一个著名的安全策略。
现在所有支持JavaScript 的浏览器都会使用这个策略。
所谓同源是指，域名，协议，端口相同。
当一个浏览器的两个tab页中分别打开来 百度和谷歌的页面
当浏览器的百度tab页执行一个脚本的时候会检查这个脚本是属于哪个页面的，
即检查是否同源，只有和百度同源的脚本才会被执行。
如果非同源，那么在请求数据时，浏览器会在控制台中报一个异常，提示拒绝访问。

## 是否允许跨域的判定
同源策略加强了安全的同时，对开发带来了极大的不便利。因此开发者又开发了多挣解决同源问题的办法，来允许数据的跨域传输。有时多个域名可以对应一个服务器，浏览器是没法通过域名来判断是否同源。而是通过服务器响应的header信息来区别是否同源的。当浏览器发现不同源的时候就会拒绝跨域。所以一般情况下我们可以看到很多请求都是有一个预请求。

### 浏览器判定流程  
（1） 浏览器先根据同源策略对前端页面和后台交互地址做匹配，若同源，则直接发送数据请求；若不同源，则发送跨域请求。  
（2） 服务器解析程序收到浏览器跨域请求后，根据自身配置返回对应文件头。若未配置过任何允许跨域，则文件头里不包含Access-Control-Allow-origin字段，若配置过域名，则返回Access-Control-Allow-origin+ 对应配置规则里的域名的方式。  
（3）浏览器根据接受到的http文件头里的Access-Control-Allow-origin字段做匹配，若无该字段，说明不允许跨域；若有该字段，则对字段内容和当前域名做比对，如果同源，则说明可以跨域，浏览器发送该请求；若不同源，则说明该域名不可跨域，不发送请求

### 配置服务器实现跨域传输

- Access-Control-Allow-Origin（必含） – 允许的域名，只能填通配符或者单域名  
- Access-Control-Allow-Methods（必含） – 这允许跨域请求的http方法（常见有POST、GET、OPTIONS）  
- Access-Control-Allow-Headers（当预请求中包含Access-Control-Request-Headers时必须包含） – 这是对预请求当中Access-Control-Request-Headers的回复，和上面一样是以逗号分隔的列表，可以返回所有支持的头部。    
- Access-Control-Allow-Credentials（可选） – 该项标志着请求当中是否包含cookies信息，只有一个可选值：true（必为小写）。如果不包含cookies，请略去该项，而不是填写false。这一项与XmlHttpRequest2对象当中的withCredentials属性应保持一致，即withCredentials为true时该项也为true；withCredentials为false时，省略该项不写。反之则导致请求失败。  
- Access-Control-Max-Age（可选） – 以秒为单位的缓存时间。预请求的的发送并非免费午餐，允许时应当尽可能缓存。